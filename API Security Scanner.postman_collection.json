{
	"info": {
		"_postman_id": "fcb14503-dd25-46b2-9525-293051708149",
		"name": "API Security Scanner",
		"description": "# Overview\n\n\"API Security Scanner\" is Collection enabling you to automatically test your API for security vulnerabilities from directly within your Postman IDE using WhiteHat Security's [Intelligent Directed DAST (ID-DAST)](https://www.whitehatsec.com).\n\n# Installation\n\nID-DAST must be installed and running on your host before you can make use of this Collection.\n\n## Docker\n\nYou can download run the ID-DAST API Linux based Docker container by executing the following commands:\n\n```\n$> docker pull whsinnovations/dast-attacker-api:latest\n$> docker run -p 27374:27374 whsinnovations/dast-attacker-api:latest\n```\n\nYou can verify the container is up and running by checking if TCP port `27374` is open and ready to accept connections:\n\n```\n$> netstat -an | grep 27374\n```\n\n*Note:* Windows users will need to enable support for Linux containers by following the [official Ubuntu documentation](https://ubuntu.com/tutorials/windows-ubuntu-hyperv-containers).\n\n# Utilization\n\nPerform the following steps to successfully execute this Collection: Record a HAR File, Configure the Scan, Run the Scan, Triage the Results\n\n## Record a HAR File\n\nYou will need to record a HTTP Archive (HAR) file associated with the collection that you wish to test. This can be achieved using technologies such as [Postman Interceptor](https://www.postman.com/product/postman-interceptor/) and [mitmproxy](https://mitmproxy.org/). By way of example, consider the following steps using mitmproxy:\n\n1. Install mitmproxy by following their [instructions](https://docs.mitmproxy.org/stable/overview-installation/).\n1. Download the [har_dump.py](https://github.com/mitmproxy/mitmproxy/blob/master/examples/contrib/har_dump.py) script to your local folder.\n1. Run mitmdump on port 8080 to export the traffic as a HAR file: `mitmdump -s ./har_dump.py --set hardump=./postman.har`\n1. Configure Postman to use a proxy on 127.0.0.1:8080 by following their [instructions](https://learning.postman.com/docs/sending-requests/capturing-request-data/proxy/).\n1. Run your Collection as you normally would. Once finished, stop the `mitmdump` process and note the newly created `postman.har` file.\n1. Make sure to disable the Postman proxy configuration before moving onto the next step.\n\n*Note:* Wouldn't it be easier if Postman could export the results of the Collection Runner directly to a HAR file so that you don't have to use a proxy? We certainly think so! If you agree, please head over to the [corresponding feature request](https://github.com/postmanlabs/postman-app-support/issues/9242) and give it an up vote.\n\n## Configure the Scan\n\nSelect the \"Submit Scan Request\" request and click the \"Body\" tab. Using the parameter name \"inputFiles\", add an individual entry for each HAR file that you want included in the scan. By way of example, the `postman.har` file captured in the previous step would be supplied here.\n\n## Run the Scan\n\nRun the collection by following the [official Postman documentation](https://learning.postman.com/docs/running-collections/intro-to-collection-runs/). This will enqueue the scan and poll the scan status until it is marked as complete. You will know the scan is complete when the Collection Runner is finishes with all tests passing. Close the Connection Runner once finished.\n\n## Triage the Results\n\nClick the \"Display Scan Results\" request and click \"Send\" to obtain the latest copy of the scan results. From within \"Display Scan Results\", click the \"Visualize\" tab to triage any and all identified vulnerabilities from within a graphical interface.\n\n# FAQ #\n\n## What are the limitations of the 'Free' version?\n\nFree versions are limited to scanning localhost applications only with a limited number of scans per month. You can scan non-localhost applications and increase the number of scans per month by [obtaining a commercial license](https://www.whitehatsec.com).\n\n## How do I configure the hosts that can be scanned?\n\nIf you have a commercial license and your HAR file references an API hosted somewhere other than localhost, then you'll need to add one or more \"allowedHosts\" parameters to the body of \"Submit Scan Request\". By way of example, if your API is running on the host \"foo.bar.com\", then you'll need to add a parameter called \"allowedHosts\" with a value of \"foo.bar.com\".\n\n## I attempted to run the Collection but got a CONNECTION REFUSED error - what's up?\n\nMake sure you disabled the proxy configuration that you used to generate a HAR file in the `Record a HAR File` step before moving onto the `Configure the Scan` step. Also verify that the ID-DAST API and the API you are testing are up and running.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Submit Scan Request",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "f03e3de6-21a0-4dc6-8bc9-1d845f20fee5",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "79f78851-0a86-4f7e-9200-50064f24ca2e",
						"exec": [
							"pm.test(\"Status code is 201\", function () {",
							"    pm.response.to.have.status(201);",
							"});",
							"",
							"let location = pm.response.headers.get(\"Location\");",
							"let index = location.lastIndexOf(\"/\");",
							"let jobID = location.substring(index + 1);",
							"pm.collectionVariables.set(\"jobID\", jobID);",
							"",
							"console.log('submit: successfully started scan with jobID: ' + jobID);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "formdata",
					"formdata": [
						{
							"key": "inputFiles",
							"type": "file",
							"src": "postman.har"
						}
					],
					"options": {
						"formdata": {}
					}
				},
				"url": {
					"raw": "{{apiHost}}/api/v1/scan",
					"host": [
						"{{apiHost}}"
					],
					"path": [
						"api",
						"v1",
						"scan"
					]
				}
			},
			"response": []
		},
		{
			"name": "Wait for Scan to Complete",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "160585dc-9ba1-4f2d-bf5e-c0c34bd89772",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "0aad5a53-15ff-46fa-a73e-d9d29a686427",
						"exec": [
							"// verify status",
							"if (pm.response.code != 200) {",
							"    throw new Error('invalid response code: ' + pm.response.code);",
							"}",
							"",
							"// wait until job is finished",
							"let message = pm.response.json();",
							"let job = message.scanJob;",
							"let finished = false;",
							"",
							"if (!job) {",
							"    console.log('poll: job not yet started...');",
							"} else if (job.status != 'succeeded' && job.status != 'failed') {",
							"    console.log('poll: job is still running... (vulnerabilities:' + job.vulnerabilities.length + ')');",
							"} else {",
							"    finished = true;",
							"    console.log('poll: scan completed with status of \"' + job.status + '\" (vulnerabilities:' + job.vulnerabilities.length + ')');",
							"}",
							"",
							"// poll if not finished",
							"if (!finished) {",
							"    setTimeout(() => {}, 1000);",
							"    postman.setNextRequest(pm.info.requestId);",
							"    return;",
							"}",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{apiHost}}/api/v1/scan/{{jobID}}",
					"host": [
						"{{apiHost}}"
					],
					"path": [
						"api",
						"v1",
						"scan",
						"{{jobID}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Display Scan Results",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "4553862d-7c86-4e3f-b592-611405aee77a",
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "29a39c4f-b641-4b23-846a-c674f532b3f0",
						"exec": [
							"// verify status",
							"if (pm.response.code != 200) {",
							"    throw new Error('invalid response code: ' + pm.response.code);",
							"}",
							"",
							"// verify job is finished",
							"let message = pm.response.json();",
							"let job = message.scanJob;",
							"if (!job || (job.status != 'succeeded' && job.status != 'failed')) {",
							"    throw new Error('bad scan job');",
							"}",
							"console.log('results: rendering scan with status of \"' + job.status + '\" (vulnerabilities:' + job.vulnerabilities.length + ')');",
							"",
							"// render results",
							"let template = `<link rel=\"stylesheet\"",
							"    href=\"https://bootswatch.com/4/united/bootstrap.min.css\"",
							"    crossorigin=\"anonymous\" />",
							"<link rel=\"stylesheet\"",
							"    href=\"https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.min.css\"",
							"    integrity=\"sha512-UyNhw5RNpQaCai2EdC+Js0QL4RlVmiq41DkmCJsRV3ZxipG2L0HhTqIf/H9Hp8ez2EnFlkBnjRGJU2stW3Lj+w==\"",
							"    crossorigin=\"anonymous\" />",
							"<link rel=\"stylesheet\"",
							"    href=\"https://cdnjs.cloudflare.com/ajax/libs/datatables.net-bs4/1.10.22/dataTables.bootstrap4.min.css\"",
							"    integrity=\"sha512-hLC0yQjFQXJ+tjTUGLL6EfiqZ4ViafLZycs1CamSWxhCEhO2ExmMBRe/qhAvHDxvQXSixhF271HIgNLAlszRHw==\"",
							"    crossorigin=\"anonymous\" />",
							"<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css\"",
							"    integrity=\"sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw==\"",
							"    crossorigin=\"anonymous\" />",
							"<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-notify/0.2.0/css/bootstrap-notify.min.css\" integrity=\"sha512-GFm9O0arU56sgj5HX9IrEtyDqKx3XhbwiTA75XTWW5JoyKnhzQ1Qj3yYbA+MLmy4p+dg5K77NCVxa3nalA96LQ==\" crossorigin=\"anonymous\" />",
							"",
							"<style>",
							"    html,body,table {",
							"        font-size: 14px;",
							"        font-weight: 400;",
							"    }",
							"",
							"    table tr td {",
							"        line-height: 3;",
							"    }",
							"",
							"    table tr td:first-child {",
							"        vertical-align: middle;",
							"    }",
							"",
							"    span.severity_fg_4:before {",
							"        content: \"Critical\";",
							"        color: var(--white);",
							"    }",
							"",
							"    span.severity_bg_4 {",
							"        background-color: var(--primary);",
							"    }",
							"",
							"    span.severity_fg_3:before {",
							"        content: \"High\";",
							"        color: var(--white);",
							"    }",
							"",
							"    span.severity_bg_3 {",
							"        background-color: var(--danger);",
							"    }",
							"",
							"    span.severity_fg_2:before {",
							"        content: \"Medium\";",
							"        color: var(--white);",
							"    }",
							"",
							"    span.severity_bg_2 {",
							"        background-color: var(--warning);",
							"    }",
							"",
							"    span.severity_fg_1:before {",
							"        content: \"Low\";",
							"        color: var(--white);",
							"    }",
							"",
							"    span.severity_bg_1 {",
							"        background-color: var(--info);",
							"    }",
							"    ",
							"    span.severity_fg_0:before {",
							"        content: \"Note\";",
							"        color: var(--white);",
							"    }",
							"",
							"    span.severity_bg_0 {",
							"        background-color: var(--success);",
							"    }",
							"",
							"    .modal-dialog {",
							"        width: 100%;",
							"        height: 100%;",
							"        margin: 0;",
							"        padding: 0;",
							"        max-width: inherit;",
							"    }",
							"",
							"    .modal-content {",
							"        height: auto;",
							"        min-height: 100%;",
							"        border-radius: 0;",
							"        border: 0px;",
							"    }",
							"",
							"    #vulnerabilities .card {",
							"        border-bottom: none;",
							"        margin-bottom: 5px;",
							"    }",
							"",
							"    #vulnerability-details a.evidence img {",
							"        border: 1px solid #ddd;",
							"        padding: 5px;",
							"        width: 256px;",
							"    }",
							"",
							"    #reference-modal .modal-body {",
							"        height: 500px;",
							"    }",
							"",
							"    #evidence-modal .modal-body img.evidence {",
							"        border: 1px solid #ddd;",
							"        padding: 5px;",
							"        width: 100%;",
							"    }",
							"</style>",
							"",
							"<div id=\"content\" class=\"container-fluid\">",
							"    <div id=\"report\">",
							"        <div class=\"modal\" id=\"evidence-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">",
							"            <div class=\"modal-dialog modal-lg\" role=\"document\">",
							"                <div class=\"modal-content\">",
							"                    <div class=\"modal-header\">",
							"                        <h5 class=\"modal-title\">Evidence</h5>",
							"                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">",
							"                            <span aria-hidden=\"true\">&times;</span>",
							"                        </button>",
							"                    </div>",
							"                    <div class=\"modal-body\">",
							"                    </div>",
							"                    <div class=\"modal-footer\">",
							"                        <span class=\"mr-auto\">",
							"                            About: This screenshot was captured during the scan and proves exploitability.",
							"                        </span>",
							"                    </div>",
							"                </div>",
							"            </div>",
							"        </div>",
							"",
							"        <div class=\"modal\" id=\"reference-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">",
							"            <div class=\"modal-dialog modal-lg\" role=\"document\">",
							"                <div class=\"modal-content\">",
							"                    <div class=\"modal-header\">",
							"                        <h5 class=\"modal-title\">Just-in-Time: MicroLesson</h5>",
							"                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">",
							"                            <span aria-hidden=\"true\">&times;</span>",
							"                        </button>",
							"                    </div>",
							"                    <div class=\"modal-body\">",
							"                    </div>",
							"                </div>",
							"            </div>",
							"        </div>",
							"",
							"        <div class=\"row mt-4 mb-4\">",
							"            <div class=\"col-12\">",
							"                <div class=\"card mb-4\">",
							"                    <div class=\"card-body\">",
							"                        <div class=\"row\">",
							"                            <div class=\"col-8\">",
							"                                <h5 class=\"mb-0\">Security Report</h5>",
							"                            </div>",
							"                        </div>",
							"                        <hr />",
							"                        <ul class=\"nav nav-pills\" id=\"pills-tab\" role=\"tablist\">",
							"                            <li class=\"nav-item mb-0\">",
							"                                <a class=\"nav-link active\" id=\"pills-home-tab\" data-toggle=\"pill\"",
							"                                    href=\"#report-overview\" role=\"tab\" aria-controls=\"pills-home\"",
							"                                    aria-selected=\"true\">Overview</a>",
							"                            </li>",
							"                            <li class=\"nav-item mb-0\">",
							"                                <a class=\"nav-link\" id=\"pills-profile-tab\" data-toggle=\"pill\"",
							"                                    href=\"#report-vulnerabilities\" role=\"tab\" aria-controls=\"pills-profile\"",
							"                                    aria-selected=\"false\">Vulnerabilities</a>",
							"                            </li>",
							"                        </ul>",
							"                        <hr />",
							"                        <div class=\"tab-content\" id=\"pills-tabContent\">",
							"                            <div class=\"tab-pane fade show active\" id=\"report-overview\" role=\"tabpanel\"",
							"                                aria-labelledby=\"pills-home-tab\">",
							"                                <div id=\"scan-overview\">",
							"                                    <dl>",
							"                                        <dt>Scan Status</dt>",
							"                                        <dd>",
							"                                            {{status}}",
							"                                        </dd>",
							"                                        {{#if error}}",
							"                                            <dt>Scan Error</dt>",
							"                                            <dd>{{error}}</dd>",
							"                                        {{/if}}",
							"                                        <dt>Total Vulnerabilities</dt>",
							"                                        <dd>",
							"                                            {{vulnerabilities.length}}",
							"                                        </dd>",
							"                                        <dt>Allowed Hosts</dt>",
							"                                        <dd>",
							"                                            <ul>",
							"                                                {{#each settings.allowedHosts}}",
							"                                                    <li>{{this}}</li>",
							"                                                {{/each}}",
							"                                            </ul>",
							"                                        </dd>",
							"                                    </dl>",
							"                                </div>",
							"                            </div>",
							"                            <div class=\"tab-pane fade\" id=\"report-vulnerabilities\" role=\"tabpanel\" aria-labelledby=\"pills-profile-tab\">",
							"                                <div id=\"vulnerabilities\">",
							"                                    <div class=\"table-responsive\">",
							"                                        <table class=\"table\">",
							"                                            <thead>",
							"                                                <tr>",
							"                                                    <th scope=\"col\">Severity</th>",
							"                                                    <th scope=\"col\">Name</th>",
							"                                                    <th scope=\"col\">Location</th>",
							"                                                    <th scope=\"col\" class=\"text-center\">Actions</th>",
							"                                                </tr>",
							"                                            </thead>",
							"                                            <tbody>",
							"                                                {{#each vulnerabilities}}",
							"                                                    <tr>",
							"                                                        <td data-order=\"{{attackClass.severity}}\">",
							"                                                            <span class=\"badge severity_bg_{{attackClass.severity}}\">",
							"                                                                <span class=\"severity_fg_{{attackClass.severity}}\"></span>",
							"                                                            </span>",
							"                                                        </td>",
							"                                                        <td>",
							"                                                            {{attackClass.name}}",
							"                                                        </td>",
							"                                                        <td>",
							"                                                            {{request.url.Path}}",
							"                                                        </td>",
							"                                                        <td class=\"text-center\">",
							"                                                            <div class=\"btn-group\">",
							"                                                                <button type=\"button\" class=\"btn btn-secondary view\" title=\"view\" data-index=\"{{@index}}\">",
							"                                                                    <span class=\"oi oi-eye\" aria-hidden=\"true\"></span>",
							"                                                                </button>",
							"                                                            </div>",
							"                                                        </td>",
							"                                                    </tr>",
							"                                                {{/each}}",
							"                                            </tbody>",
							"                                        </table>",
							"                                    </div>",
							"                                </div>",
							"                                <div id=\"vulnerability-details\">",
							"                                    {{#each vulnerabilities}}",
							"                                    <div id=\"vulnerability-details_{{@index}}\" class=\"d-none details\">",
							"                                        <div class=\"row mb-2\">",
							"                                            <div class=\"col-12\">",
							"                                                <a href=\"#\" class=\"back\">",
							"                                                    &lt;&lt; Back to Vulnerabilities",
							"                                                </a>",
							"                                            </div>",
							"                                        </div>",
							"                                        <dl>",
							"                                            <dt>Name</dt>",
							"                                            <dd>{{attackClass.name}}</dd>",
							"                                            <dt>Severity</dt>",
							"                                            <dd>",
							"                                                <span class=\"badge severity_bg_{{attackClass.severity}}\">",
							"                                                    <span class=\"severity_fg_{{attackClass.severity}}\"></span>",
							"                                                </span>",
							"                                            </dd>",
							"                                            <dt>URL</dt>",
							"                                            <dd>",
							"                                                {{request.url.Scheme}}://{{request.url.Host}}{{request.url.Path}}",
							"                                            </dd>",
							"                                            <dt>Attack</dt>",
							"                                            <dd>",
							"                                                The &quot;{{target}}&quot; field was attacked",
							"                                                using the payload {{payload}}",
							"                                            </dd>",
							"                                            {{#each attackClass.attackTexts as |text|}}",
							"                                                <dt>{{text.label}}</dt>",
							"                                                <dd>",
							"                                                    {{{text.value}}}",
							"                                                </dd>",
							"                                            {{/each}}",
							"                                            <dt>Evidence</dt>",
							"                                            <dd>",
							"                                                {{#each evidences}}",
							"                                                    <a href=\"#\" class=\"evidence\">",
							"                                                        <img src=\"data:image/png;base64,{{this}}\" alt=\"evidence\" />",
							"                                                    </a>",
							"                                                {{/each}}",
							"                                            </dd>",
							"                                            <dt>Videos</dt>",
							"                                            <dd>",
							"                                                <ul class=\"lessons\">",
							"                                                    {{#each attackClass.lessons}}",
							"                                                        <li>",
							"                                                            <a href=\"{{value}}\" target=\"_blank\" class=\"reference\">",
							"                                                                {{title}}",
							"                                                            </a>",
							"                                                        </li>",
							"                                                    {{/each}}",
							"                                                </ul>",
							"                                            </dd>",
							"                                            <dt>Request</dt>",
							"                                            <dd>",
							"            <pre>{{request.method}} {{request.url.Path}} HTTP/1.1",
							"{{#each request.headers}}",
							"{{@key}}: {{this}}",
							"{{/each}}",
							"",
							"{{request.body.raw}}</pre>",
							"                                            </dd>",
							"                                            <dt>Response</dt>",
							"                                            <dd>",
							"            <pre>HTTP/1.1 {{response.status.code}} {{response.status.text}}",
							"{{#each response.headers}}",
							"{{@key}}: {{this}}",
							"{{/each}}",
							"",
							"{{response.body.raw}}</pre>",
							"                                            </dd>",
							"                                        </dl>",
							"                                    </div>",
							"                                    {{/each}}",
							"                                </div>",
							"                            </div>",
							"                        </div>",
							"                    </div>",
							"                </div>",
							"            </div>",
							"        </div>",
							"    </div>",
							"</div>",
							"",
							"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>",
							"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js\" integrity=\"sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg==\" crossorigin=\"anonymous\"></script>",
							"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js\" integrity=\"sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==\" crossorigin=\"anonymous\"></script>",
							"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/bootstrap-notify/0.2.0/js/bootstrap-notify.min.js\" integrity=\"sha512-vCgNjt5lPWUyLz/tC5GbiUanXtLX1tlPXVFaX5KAQrUHjwPcCwwPOLn34YBFqws7a7+62h7FRvQ1T0i/yFqANA==\" crossorigin=\"anonymous\"></script>",
							"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/datatables.net-bs4/1.10.22/dataTables.bootstrap4.js\" integrity=\"sha512-SOUJxnrrYg/FO1OY7UDw1h0nUw2LtMar68dNgVwekH2Rm+BdVNO5OTHOfDCGtTGcnZbXBHvWkIoh2WTyFIXVNg==\" crossorigin=\"anonymous\"></script>",
							"<script>",
							"    // run report",
							"    $(document).ready(function() {",
							"        // register details links",
							"        $('#vulnerabilities button.view').on('click', function(e) {",
							"            $('#vulnerabilities').addClass('d-none');",
							"            let index = parseInt($(this).attr('data-index'));",
							"            $('#vulnerability-details_' + index).removeClass('d-none');",
							"        });",
							"",
							"        $('#vulnerability-details .details a.back').on('click', function(e) {",
							"            let details = $(this).parents('.details');",
							"            $(details).addClass('d-none');",
							"            $('#vulnerabilities').removeClass('d-none');",
							"        });",
							"",
							"        $('#vulnerability-details a.evidence').on('click', function (e) {",
							"            e.preventDefault();",
							"",
							"            let src = $(this).find('img:first-child').attr('src');",
							"            let img = $('<img class=\"evidence\"></img>');",
							"            $(img).attr('src', src);",
							"",
							"            $('#evidence-modal div.modal-body').html(img);",
							"            $('#evidence-modal').modal('show');",
							"        });",
							"",
							"        $('#vulnerability-details a.reference').on('click', function (e) {",
							"            e.preventDefault();",
							"",
							"            let title = $(this).text();",
							"            let href = $(this).attr('href');",
							"            let iframe = document.createElement('iframe');",
							"",
							"            iframe.frameBorder = \"0\";",
							"            iframe.height = \"100%\";",
							"            iframe.width = \"100%\";",
							"            iframe.src = href;",
							"",
							"            $('#reference-modal .modal-title').text(title);",
							"            $('#reference-modal div.modal-body').empty();",
							"            $('#reference-modal div.modal-body').append(iframe);",
							"            $('#reference-modal').modal('show');",
							"        });",
							"",
							"        // load vulnerability table",
							"        let vtable = $('#vulnerabilities table').dataTable({",
							"            'order': [[0, 'desc']]",
							"        });",
							"    });",
							"</script>`;",
							"",
							"pm.visualizer.set(template, job);"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{apiHost}}/api/v1/scan/{{jobID}}",
					"host": [
						"{{apiHost}}"
					],
					"path": [
						"api",
						"v1",
						"scan",
						"{{jobID}}"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "bfc7a9a6-f303-4dd3-bc79-dcdaa0f43587",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "b57fe0f2-774b-412f-867e-d1ee69c450de",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "5750ad3b-f501-4912-9fb8-8878990ddafb",
			"key": "apiHost",
			"value": "http://localhost:27374"
		},
		{
			"id": "f57a5ce8-6d6d-4e48-a081-84bb05649b7d",
			"key": "jobID",
			"value": ""
		}
	],
	"protocolProfileBehavior": {}
}